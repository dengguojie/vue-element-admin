[
  {
    "op": "SyncBatchNormBackwardElemt",
    "case_name" : "test_dynamic_SyncBatchNormBackwardElemt_fp32_0",
    "input_desc": [
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "grad_output"
      },
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "save_input"
      },
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "mean"
      },
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "invstd"
      },
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "weight"
      },
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "mean_dy"
      },
      {
        "format": "ND",
        "shape": [-1, 1],
        "typical_shape": [1, 1],
        "shape_range": [[1, 1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "mean_dy_xmu"
      }
    ],
    "output_desc": [
      {
        "name": "grad_input",
        "format": "ND",
        "ori_format": "ND",
        "type": "float32",
        "shape": [-1, 1],
        "ori_shape": [1, 1],
        "shape_range": [[1, 1]],
        "typical_shape": [1, 1]
      }
    ]
  },
  {
    "op": "SyncBatchNormBackwardElemt",
    "case_name" : "test_dynamic_SyncBatchNormBackwardElemt_fp32_1",
    "input_desc": [
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "grad_output"
      },
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "save_input"
      },
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "mean"
      },
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "invstd"
      },
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "weight"
      },
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "mean_dy"
      },
      {
        "format": "ND",
        "shape": [-1, 2, 4, 3],
        "typical_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "type": "float32",
        "value_range": [[1, 1]],
        "data_distribute":"uniform",
        "name": "mean_dy_xmu"
      }
    ],
    "output_desc": [
      {
        "name": "grad_input",
        "format": "ND",
        "ori_format": "ND",
        "type": "float32",
        "shape": [-1, 2, 4, 3],
        "ori_shape": [1, 2, 4, 3],
        "shape_range": [[1, -1]],
        "typical_shape": [1, 2, 4, 3]
      }
    ]
  },
  {
    "op": "SyncBatchNormBackwardElemt",
    "case_name" : "test_dynamic_SyncBatchNormBackwardElemt_fp16_0",
    "input_desc": [
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "grad_output"
      },
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "save_input"
      },
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "mean"
      },
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "invstd"
      },
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "weight"
      },
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "mean_dy"
      },
      {
        "format": "ND",
        "shape": [-1, 3, 1, 1, 4],
        "typical_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "mean_dy_xmu"
      }
    ],
    "output_desc": [
      {
        "name": "grad_input",
        "format": "ND",
        "ori_format": "ND",
        "type": "float16",
        "shape": [-1, 3, 1, 1, 4],
        "ori_shape": [1, 3, 1, 1, 4],
        "shape_range": [[1, -1]],
        "typical_shape": [1, 3, 1, 1, 4]
      }
    ]
  },
  {
    "op": "SyncBatchNormBackwardElemt",
    "case_name" : "test_dynamic_SyncBatchNormBackwardElemt_fp16_1",
    "input_desc": [
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "grad_output"
      },
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "save_input"
      },
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "mean"
      },
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "invstd"
      },
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "weight"
      },
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "mean_dy"
      },
      {
        "format": "ND",
        "shape": [1, -1, 2, 3, 4],
        "typical_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "type": "float16",
        "value_range": [[0.1, 1.0]],
        "data_distribute":"uniform",
        "name": "mean_dy_xmu"
      }
    ],
    "output_desc": [
      {
        "name": "grad_input",
        "format": "ND",
        "ori_format": "ND",
        "type": "float16",
        "shape": [1, -1, 2, 3, 4],
        "ori_shape": [1, 1, 2, 3, 4],
        "shape_range": [[1, -1]],
        "typical_shape": [1, 1, 2, 3, 4]
      }
    ]
  }
]